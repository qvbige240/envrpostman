var res = {
    Data_json:"res/Data.json",
    DataEn_json:"res/Data_en.json",
    Level_json:"res/Level.json",
    Login_json:"res/Login.json",
    Main_json:"res/Main.json",
    Pause_json:"res/Pause.json",
    Failed_json:"res/Failed.json",
    Success_json:"res/Success.json",
    Postman_json:"res/Postman.json",
    Msgbox_json:"res/MsgBox.json",
    Shop_json:"res/Shop.json",
    PostmanBg_json:"res/PostmanBg.json",
    Mog_json:"res/spine/mog/mog.json",
    Mog_atlas:"res/spine/mog/mog.atlas",
    Mog_png:"res/spine/mog/mog.png",
    Chuansj_json:"res/spine/chuansj/chuansj.json",
    Chuansj_atlas:"res/spine/chuansj/chuansj.atlas",
    chuansj_png:"res/spine/chuansj/chuansj.png",
    haig_json:"res/spine/haig/haig.json",
    haig_atlas:"res/spine/haig/haig.atlas",
    haig_png:"res/spine/haig/haig.png",
    fant_json:"res/spine/fant/fant.json",
    fant_atlas:"res/spine/fant/fant.atlas",
    fant_png:"res/spine/fant/fant.png",
    rongm_json:"res/spine/rongm/rongm.json",
    rongm_atlas:"res/spine/rongm/rongm.atlas",
    rongm_png:"res/spine/rongm/rongm.png",
    xiaox_json:"res/spine/xiaox/xiaox.json",
    xiaox_atlas:"res/spine/xiaox/xiaox.atlas",
    xiaox_png:"res/spine/xiaox/xiaox.png",
    Zhujue_json:"res/spine/zhujue/zhujue.json",
    Zhujue_atlas:"res/spine/zhujue/zhujue.atlas",
    zhujue_png:"res/spine/zhujue/zhujue.png",
    Zhujue2_json:"res/spine/zhujue2/zhujue.json",
    Zhujue2_atlas:"res/spine/zhujue2/zhujue.atlas",
    zhujue2_png:"res/spine/zhujue2/zhujue.png",
    Zhujue3_json:"res/spine/zhujue3/zhujue.json",
    Zhujue3_atlas:"res/spine/zhujue3/zhujue.atlas",
    zhujue3_png:"res/spine/zhujue3/zhujue.png",
    Speedup_json:"res/spine/jstx/jstx.json",
    Speedup_atlas:"res/spine/jstx/jstx.atlas",
    jstx_png:"res/spine/jstx/jstx.png",
    Success1_json:"res/spine/shengli/shengli.json",
    Success_atlas:"res/spine/shengli/shengli.atlas",
    Success_png:"res/spine/shengli/shengli.png",
    Success_en_json:"res/spine/shenglia/shenglia.json",
    Success_en_atlas:"res/spine/shenglia/shenglia.atlas",
    Success_en_png:"res/spine/shenglia/shenglia.png",
    Failed1_json:"res/spine/shibai/shibai.json",
    Failed_atlas:"res/spine/shibai/shibai.atlas",
    Failed_png:"res/spine/shibai/shibai.png",
    Failed_en_json:"res/spine/shibaia/shibaia.json",
    Failed_en_atlas:"res/spine/shibaia/shibaia.atlas",
    Failed_en_png:"res/spine/shibaia/shibaia.png",
    Level_plist:"res/PlistLevel.plist",
    Common_plist:"res/PlistCommon.plist",
    Common_plist2:"res/PlistCommon2.plist",
    Jinbitx_json:"res/spine/jiasutx/daoju2.json",
    Jinbitx_atlas:"res/spine/jiasutx/daoju2.atlas",
    jiasutx_png:"res/spine/jiasutx/daoju2.png",
    Jiasutx_json:"res/spine/jinbitx/daoju2.json",
    Jiasutx_atlas:"res/spine/jinbitx/daoju2.atlas",
    jinbitx_png:"res/spine/jinbitx/daoju2.png",
    tupotx_json:"res/spine/tupotx/tupotx.json",
    tupotx_atlas:"res/spine/tupotx/tupotx.atlas",
    tupotx_png:"res/spine/tupotx/tupotx.png",
    tupotxa_json:"res/spine/tupotxa/tupotxa.json",
    tupotxa_atlas:"res/spine/tupotxa/tupotxa.atlas",
    tupotxa_png:"res/spine/tupotxa/tupotxa.png",
    Revive_json:"res/spine/fuhuo/fuhuo.json",
    Revive_atlas:"res/spine/fuhuo/fuhuo.atlas",
    fuhuo_png:"res/spine/fuhuo/fuhuo.png",
    Luoshi_json:"res/spine/luoshi/luoshi.json",
    Luoshi_atlas:"res/spine/luoshi/luoshi.atlas",
    luoshi_png:"res/spine/luoshi/luoshi.png",
    Chuguai_json:"res/spine/chuguai/chuguaits.json",
    Chuguai_atlas:"res/spine/chuguai/chuguaits.atlas",
    chuguai_png:"res/spine/chuguai/chuguaits.png",
    Baoz_json:"res/spine/baoz/baoz.json",
    Baoz_atlas:"res/spine/baoz/baoz.atlas",
    baoz_png:"res/spine/baoz/baoz.png",
    dab_json:"res/spine/dab/dab.json",
    dab_atlas:"res/spine/dab/dab.atlas",
    dab_png:"res/spine/dab/dab.png",
    huanx_json:"res/spine/huanx/huanx.json",
    huanx_atlas:"res/spine/huanx/huanx.atlas",
    huanx_png:"res/spine/huanx/huanx.png",
    nuj_json:"res/spine/nuj/nuj.json",
    nuj_atlas:"res/spine/nuj/nuj.atlas",
    nuj_png:"res/spine/nuj/nuj.png",
    shug_json:"res/spine/shug/shug.json",
    shug_atlas:"res/spine/shug/shug.atlas",
    shug_png:"res/spine/shug/shug.png",
    zhu_json:"res/spine/zhu/zhu.json",
    zhu_atlas:"res/spine/zhu/zhu.atlas",
    zhu_png:"res/spine/zhu/zhu.png",
    dropblood_json:"res/spine/shanhong/shanhong.json",
    dropblood_atlas:"res/spine/shanhong/shanhong.atlas",
    dropblood_png:"res/spine/shanhong/shanhong.png",
    Font_path:"res/Font/DFWaWaW5.TTF",
    Main_bgm:"res/Sound/menu_bgm.mp3"
};

var g_resources = [];
for (var i in res) {
    g_resources.push(res[i]);
}

var loadResources = function () {
    cc.log("loadResources");
    //读取配置数据
    if (IsChinese)
    {
        GlobalData = cc.loader.getRes("res/Data.json");
    }
    else
    {
        GlobalData = cc.loader.getRes("res/Data_en.json");
    }

    cc.spriteFrameCache.addSpriteFrames(res["Level_plist"]);
    cc.spriteFrameCache.addSpriteFrames(res["Common_plist"]);
    cc.spriteFrameCache.addSpriteFrames(res["Common_plist2"]);
//添加道路的资源
    var spriteFrame = new cc.SpriteFrame("res/Common/_0054a.png", cc.rect(0, 0, 1280, 437));
    cc.spriteFrameCache.addSpriteFrame(spriteFrame, "Common/_0054a.png");
    var spriteFrame2 = new cc.SpriteFrame("res/Common/_0055a.png", cc.rect(0, 0, 1280, 437));
    cc.spriteFrameCache.addSpriteFrame(spriteFrame2, "Common/_0055a.png");
    var spriteFrame3 = new cc.SpriteFrame("res/Common/_0084a.png", cc.rect(0, 0, 1280, 437));
    cc.spriteFrameCache.addSpriteFrame(spriteFrame3, "Common/_0084a.png");
    var spriteFrame4 = new cc.SpriteFrame("res/Common/_0085a.png", cc.rect(0, 0, 1280, 437));
    cc.spriteFrameCache.addSpriteFrame(spriteFrame4, "Common/_0085a.png");
    var spriteFrame5 = new cc.SpriteFrame("res/Common/_0086a.png", cc.rect(0, 0, 1280, 437));
    cc.spriteFrameCache.addSpriteFrame(spriteFrame5, "Common/_0086a.png");
    var spriteFrame6 = new cc.SpriteFrame("res/Common/_0087a.png", cc.rect(0, 0, 1280, 437));
    cc.spriteFrameCache.addSpriteFrame(spriteFrame6, "Common/_0087a.png");
}

var LoadingScene = cc.Scene.extend({
    ctor: function () {
        this._super();



        //start add by duz on 2015.11.24 for add loadingScene
        var animation = cc.Animation.create();
        console.log("duzhong");
        var self = this;
        //解析Json文件
        cc.loader.loadTxt("res/loadingConfig.json", function(a, fileContent){
            console.log(fileContent);
            var jsonData = JSON.parse(fileContent);
            var data = jsonData["loadingList"];
            if (data) {
                var len = data.length;
                for (var i = 0; i < len; i++) {
                    //文件名
                    var fileName = data[i];
                    animation.addSpriteFrameWithFile(fileName);
                    console.log(fileName);
                }
            }
            animation.setDelayPerUnit(0.15);           //设置两个帧播放时间
            animation.setRestoreOriginalFrame(true);    //动画执行后还原初始状态
            //创建动作
            var action = cc.animate(animation);
            data = jsonData["loadingBg"];
            console.log(data);
            //取得x,y坐标
            var x = jsonData["PositionX"];
            var y = jsonData["PositionY"];

            //背景精灵
            var bg = new cc.Sprite(data);
            bg.attr({
                anchorX : 0.5,
                anchorY : 0.5,
                x : cc.winSize.width/2,
                y : cc.winSize.height/2
            });
            //因为游戏分辨率跟资源不一致
            var sclX = cc.winSize.width*1.0 / 1024;
            var sclY = cc.winSize.height*1.0 / 600;
            //console.log("sclx:"+sclX);
            //console.log("scly:"+sclY);
            //缩放
            bg.scaleX = sclX;
            bg.scaleY = sclY;

            self.addChild(bg);
            //loading 精灵
            var loading = new cc.Sprite();
            loading.attr({
                anchorX : 0.5,
                anchorY : 0.5,
                x : parseFloat(x),
                y : parseFloat(y)
            });
            console.log("width:" + cc.winSize.width );
            console.log("height:" + cc.winSize.height );
            self.scheduleOnce(function(){
                loadResources();
                //cc.director.replaceScene(new MainScene());
                cc.director.runScene(new MainScene());
            }, 2);
            self.addChild(loading);
            //运行动画
            loading.runAction(cc.repeatForever(action));
        });
        //end


	/*
	   var visibleSize = cc.director.getVisibleSize();
        var loadingImg = new ccui.ImageView("res/loading.png");
        loadingImg.ignoreContentAdaptWithSize(false);
        loadingImg.setContentSize(visibleSize);
        loadingImg.setAnchorPoint(cc.p(0, 0));
        this.addChild(loadingImg);

        var delayTime = cc.delayTime(0.01);
        var callFunc = cc.callFunc(function () {
            loadResources();
            cc.director.replaceScene(new MainScene());
        });
        this.runAction(cc.sequence(delayTime, callFunc));
	*/
    },
});

var preLoadResources = function () {
    //启动画面
    if (cc.sys.isNative && cc.sys.OS_ANDROID == cc.sys.os)
    {
        cc.director.runScene(new LoadingScene());
    }
    else
    {
        loadResources();
    }
}
